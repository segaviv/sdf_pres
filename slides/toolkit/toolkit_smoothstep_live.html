<!DOCTYPE html><html style="height:100%;width:100%;background-color:#fff"><script src="https://segaviv.github.io/sdf_pres/slides/3d/boolean_ops_live.63dbaaf1.js"></script><script src="https://segaviv.github.io/sdf_pres/slides/3d/boolean_ops_live.795393b1.js"></script><link rel="stylesheet" href="https://segaviv.github.io/sdf_pres/slides/3d/boolean_ops_live.d1b9ff40.css"><link rel="stylesheet" href="https://segaviv.github.io/sdf_pres/slides/3d/boolean_ops_live.0e0bec62.css"><script src="https://segaviv.github.io/sdf_pres/slides/3d/boolean_ops_live.da5b651f.js"></script><script src="https://segaviv.github.io/sdf_pres/slides/3d/boolean_ops_live.be88f05d.js"></script><link rel="stylesheet" href="https://segaviv.github.io/sdf_pres/slides/3d/boolean_ops_live.cfb110c9.css"><script src="https://segaviv.github.io/sdf_pres/slides/3d/boolean_ops_live.d4381dda.js"></script><link type="text/css" rel="stylesheet" href="https://segaviv.github.io/sdf_pres/slides/3d/boolean_ops_live.9e745220.css"><body style="height:100%;width:100%;justify-content:center;display:flex;overflow:hidden"> <div style="height:100%;width:95%;display:flex"> <div style="height:100%;flex-direction:column;flex:auto;justify-content:center;align-items:center;margin-right:20px;display:flex"> <canvas style="height:400px;width:400px;margin-bottom:20px" id="canvas" class="canvas"> </canvas> <div id="controls" style="width:100%;background-color:#f0f8ff;display:flex"> <div style="display:flex"> <span id="time" contenteditable="" style="margin-left:2px;margin-right:2px"> 0.00</span>s </div> </div> </div> <div id="code" style="height:90%;width:50%;opacity:.9;align-items:center;display:flex;top:5%"> <textarea id="textarea" style="height:100%;width:100%">
      </textarea> </div> </div> <div style="display:block;position:absolute;bottom:0;left:10px;right:10px"> <input id="command" style="width:100%;display:none"> </div> </body><script>const autoUniformRegex=/\/\*\s*([a-z\d]+)\s*\*\/\s*([a-zA-Z\d]+)/g,assignmentRegex=/([a-zA-Z\d]+)\s*\=/g,codeElem=document.getElementById("code"),commandElem=document.getElementById("command"),timeElem=document.getElementById("time"),FLOAT_PRECISION="#version 300 es\n   precision mediump float;\n    out vec4 fragColor;\n    #define iResolution res\n    #define iFrame 0\n    #define HW_PERFORMANCE 0\n    #define iTime time\n    #define iMouse vec2(0.)\n\n    uniform vec2 res;\n    uniform float time;\n    ",FRAG_SHARDER_SUFFIX="\n  void main() {\n      vec4 temp;\n      mainImage(temp, gl_FragCoord.xy);\n      fragColor = vec4(temp.xyz, 1.0);\n    }\n  ",vsSource="#version 300 es\n in vec4 aVertexPosition; void main(){gl_Position = aVertexPosition;}",fsSource="\n    #define RED vec3(1.0, 0.0, 0.0)\n    #define WHITE vec3(1.0, 1.0, 1.0)\n    #define BLACK vec3(0.0)\n\n    float linstep(float a, float b, float x) {\n      return clamp((x-a) / (b-a), 0., 1.);\n    }\n\n    vec4 leftSide(vec2 p) {\n      p.x += (res.x / res.y) / 2.;\n      float d = length(p) - 0.5;\n      float t = step(0., d) * (1.-/*float*/a) + a*linstep(-0.2, 0.2, d);\n      t = t * (1. - /*float*/b) + b * smoothstep(-0.2, 0.2, d);\n      return vec4(mix(RED, WHITE, t), 1.0);\n    }\n\n    vec4 rightSide(vec2 p) {\n      float aspect_ratio = res.x / res.y;\n      p.x = (p.x - (aspect_ratio) / 2.) * 1.5 + (aspect_ratio) / 2.;\n      p.y = p.y * 1.2;\n      float stepf = step((aspect_ratio) / 2., p.x);\n      float linf = linstep(0., (aspect_ratio), p.x);\n      float smoothf = smoothstep(0., (aspect_ratio), p.x);\n      float t = stepf * (1. - a) + a * linf;\n      float t2 = t * (1. - b) + b * smoothf;\n\n      vec3 col = mix(BLACK, WHITE, smoothstep(0., 0.02, abs(t2-(p.y+1.)/2.)));\n      if ((p.y + 1.) / 2. < t && (p.y + 1.) / 2. > 1. - t) {\n      col *= \n       step(0.02, abs(p.x - aspect_ratio/2.));\n      }\n      return vec4(col, 1.);\n    }\n\n    void mainImage(out vec4 fragColor, in vec2 fragCoord) {\n      vec2 p = fragCoord / res * 2.0 - 1.0;\n      p.x *= res.x / res.y;\n      if (p.x < 0.) {\n        fragColor = leftSide(p);\n      } else {\n        fragColor = rightSide(p);\n      }\n      vec2 q = fragCoord.xy/res;\n      fragColor *= pow( 16.0*q.x*q.y*(1.0-q.x)*(1.0-q.y), 0.07 );\n    }\n  ";var _transitions=[{transitionForward:()=>interpolate("a",1),transitionBackward:()=>interpolate("a",0),index:1},{transitionForward:()=>interpolate("b",1),transitionBackward:()=>interpolate("b",0),index:3}];const AUTO_COMPILE_DELAY_MS=250,canvas=document.getElementById("canvas"),controls=document.getElementById("controls"),gl=canvas.getContext("webgl2"),input=document.getElementById("textarea");let editor;input.value=fsSource;var autoCompile=!1;let gShaderProgram=null,gBuffers=null,gProgramInfo=null,triggerCompilerTimeout=null,compilePromise=null,gUniforms=new Map,uniformsGui={};const guiControllers=new Map;let configGui={aspect_ratio:1.777,width:400,animate:!1},animateController,lastTimestamp=null,gui=new dat.GUI;function initBuffers(e){const t=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,t);return e.bufferData(e.ARRAY_BUFFER,new Float32Array([1,1,-1,1,1,-1,-1,-1]),e.STATIC_DRAW),{position:t}}function createTexture(e){const t=gl.createTexture();return gl.bindTexture(gl.TEXTURE_2D,t),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_S,gl.CLAMP_TO_EDGE),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_T,gl.CLAMP_TO_EDGE),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MIN_FILTER,gl.NEAREST),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MAG_FILTER,gl.NEAREST),gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,gl.RGBA,gl.UNSIGNED_BYTE,e),t}function initShaderProgram(e,t,n,o){const i=loadShader(e,e.VERTEX_SHADER,t,o);if(null==i)return null;const a=loadShader(e,e.FRAGMENT_SHADER,n,o);if(null==a)return e.deleteShader(i),null;const r=e.createProgram();return e.attachShader(r,i),e.attachShader(r,a),e.linkProgram(r),e.deleteShader(i),e.deleteShader(a),e.getProgramParameter(r,e.LINK_STATUS)?r:(console.log("Unable to initialize the shader program: "+e.getProgramInfoLog(r)),e.deleteProgram(r),null)}function unique(e){return[...new Set(e)]}function reportErrorCompilingShader(e,t){unique([...e.matchAll(/0\:\d+/g)].map((e=>e[0]))).forEach((n=>{const o=n.split(":"),i=parseInt(o[1])-t+1;e=e.replaceAll(n,`${o[0]}:${i}`),editor.addLineClass(i-1,"background","redBackground")})),e=e.replaceAll("\n","<br>"),SnackBar({message:e,status:"error",timeout:!1})}function loadShader(e,t,n,o){const i=e.createShader(t);return e.shaderSource(i,n),e.compileShader(i),e.getShaderParameter(i,e.COMPILE_STATUS)?i:(reportErrorCompilingShader(e.getShaderInfoLog(i),o),e.deleteShader(i),null)}function drawScene(e,t,n,o){e.width=e.clientWidth*window.devicePixelRatio,e.height=e.clientHeight*window.devicePixelRatio,t.viewport(0,0,t.canvas.width,t.canvas.height),t.clearColor(0,0,0,1),t.clear(t.COLOR_BUFFER_BIT);{const e=2,i=t.FLOAT,a=!1,r=0,l=0;t.bindBuffer(t.ARRAY_BUFFER,o.position),t.vertexAttribPointer(n.attribLocations.vertexPosition,e,i,a,r,l),t.enableVertexAttribArray(n.attribLocations.vertexPosition)}t.useProgram(n.program),t.uniform2f(n.uniformLocations.res,e.width,e.height),t.uniform1f(n.uniformLocations.time,parseFloat(timeElem.innerText)),updateUniformValues();{const e=0,n=4;t.drawArrays(t.TRIANGLE_STRIP,e,n)}}async function init(){configGui.width=canvas.parentElement.parentElement.clientWidth,editor=CodeMirror.fromTextArea(document.getElementById("textarea"),{mode:"x-shader/x-fragment",lineNumbers:!0,lineWrapping:!0,extraKeys:{"Ctrl-Space":"autocomplete"},indentUnit:2}),editor.getWrapperElement().style.height="100%",editor.on("change",(()=>{autoCompile&&(triggerCompilerTimeout&&clearTimeout(triggerCompilerTimeout),setTimeout((()=>{compilePromise=compile()}),AUTO_COMPILE_DELAY_MS))})),gBuffers=initBuffers(gl),compilePromise=compile(),await compilePromise,codeElem.style.display="none",controls.style.display="none",resizeCanvas()}function defaultValueForType(e){switch(e){case"int":case"float":return 0;case"vec2":return[0,0];case"vec3":case"col":return[0,0,0];case"vec4":return[0,0,0,0]}return""}function extractUniforms(){const e=[...editor.getValue().matchAll(autoUniformRegex)],t=new Set(e.map((e=>e[2])));[...gUniforms.keys()].filter((e=>!t.has(e))).forEach((e=>gUniforms.delete(e))),e.forEach((e=>{gUniforms.has(e[2])&&gUniforms.get(e[2]).type==e[1]||gUniforms.set(e[2],{type:e[1],value:defaultValueForType(e[1])})})),createUniformGui()}function getUniformString(){let e="";return gUniforms.forEach(((t,n)=>{const o="col"==t.type?"vec3":t.type;e+=`uniform ${o} ${n};`})),e}function resizeCanvas(){canvas.style.width=`${configGui.width}px`,canvas.style.height=configGui.width/configGui.aspect_ratio+"px",canvas.width=canvas.clientWidth,canvas.height=canvas.clientHeight,gl.viewport(0,0,gl.canvas.width,gl.canvas.height),controls.style.width=`${canvas.clientWidth}px`,onUniformUpdate(),updateCodeEditorType()}function createReconfigGui(){animateController=gui.add(configGui,"animate").onChange((()=>{handleAnimateChange()})),gui.add(window,"autoCompile");const e=gui.addFolder("Sizing");e.add(configGui,"aspect_ratio",void 0,void 0,.01).onChange((()=>resizeCanvas())),e.add(configGui,"width",200,window.innerWidth).onChange((()=>resizeCanvas()))}function createUniformGui(){gui.destroy(),guiControllers.clear(),uniformsGui={},gui=new dat.GUI,createReconfigGui(),gui.hide(),gUniforms.forEach(((e,t)=>{switch(e.type){case"int":case"float":return uniformsGui[t]=e.value,void guiControllers.set(t,gui.add(uniformsGui,t,void 0,void 0,.01).onChange((()=>{e.value=uniformsGui[t],onUniformUpdate()})));case"vec2":case"vec3":case"vec4":return uniformsGui[`${t}.x`]=e.value[0],guiControllers.set(t,gui.add(uniformsGui,`${t}.x`,void 0,void 0,.01).onChange((()=>{e.value[0]=uniformsGui[`${t}.x`],onUniformUpdate()}))),uniformsGui[`${t}.y`]=e.value[1],guiControllers.set(t,gui.add(uniformsGui,`${t}.y`,void 0,void 0,.01).onChange((()=>{e.value[1]=uniformsGui[`${t}.y`],onUniformUpdate()}))),"vec2"!=e.type&&(uniformsGui[`${t}.z`]=e.value[2],guiControllers.set(t,gui.add(uniformsGui,`${t}.z`,void 0,void 0,.01).onChange((()=>{e.value[2]=uniformsGui[`${t}.z`],onUniformUpdate()})))),void("vec4"==e.type&&(uniformsGui[`${t}.w`]=e.value[3],guiControllers.set(t,gui.add(uniformsGui,`${t}.w`,void 0,void 0,.01).onChange((()=>{e.value[3]=uniformsGui[`${t}.w`],onUniformUpdate()})))));case"col":uniformsGui[t]=e.value.map((e=>255*e)),guiControllers.set(t,gui.addColor(uniformsGui,t).onChange((()=>{e.value=uniformsGui[t].map((e=>e/255)),onUniformUpdate()})))}}))}function updateUniformValues(){gUniforms.forEach(((e,t)=>{const n=gl.getUniformLocation(gShaderProgram,t);switch(e.type){case"int":return void gl.uniform1i(n,e.value);case"float":return void gl.uniform1f(n,e.value);case"vec2":return void gl.uniform2fv(n,e.value);case"vec3":case"col":return void gl.uniform3fv(n,e.value);case"vec4":return void gl.uniform4fv(n,e.value)}}))}function onUniformUpdate(){drawScene(canvas,gl,gProgramInfo,gBuffers)}function clearSnackbars(){[...document.getElementsByClassName("js-snackbar-container")].forEach((e=>e.remove())),[...Array(editor.lineCount()).keys()].forEach((e=>editor.removeLineClass(e,"background")))}async function compile(){return new Promise(((e,t)=>{clearSnackbars(),extractUniforms();const n=FLOAT_PRECISION+getUniformString(),o=n.split("\n").length,i=n+editor.getValue()+FRAG_SHARDER_SUFFIX,a=initShaderProgram(gl,vsSource,i,o);a?(SnackBar({status:"success",message:"Compiled successfully",timeout:1e3}),e(a)):t("failed")})).then((e=>{compilePromise=null,gl.deleteProgram(gShaderProgram),gShaderProgram=e,gProgramInfo={program:gShaderProgram,attribLocations:{vertexPosition:gl.getAttribLocation(gShaderProgram,"aVertexPosition")},uniformLocations:{res:gl.getUniformLocation(gShaderProgram,"res"),time:gl.getUniformLocation(gShaderProgram,"time")}},drawScene(canvas,gl,gProgramInfo,gBuffers)}))}function updateCodeEditorType(){canvas.clientWidth>=.7*canvas.parentElement.parentElement.clientWidth?codeElem.classList.add("floatingEditor"):codeElem.classList.remove("floatingEditor")}function handleAnimateChange(){configGui.animate&&requestAnimationFrame(animate)}function animate(e){if(lastTimestamp){const t=e-lastTimestamp;let n=parseFloat(timeElem.innerText);n+=t/1e3,timeElem.innerText=n.toFixed(3)}onUniformUpdate(),configGui.animate?(lastTimestamp=e,requestAnimationFrame(animate)):lastTimestamp=null}function mix(e,t,n){return Array.isArray(e)?e.map(((e,o)=>e*(1-n)+t[o]*n)):e*(1-n)+t*n}function linstep(e,t,n){return Math.max(0,Math.min(1,(n-e)/(t-e)))}function smoothstep(e,t,n){const o=linstep(e,t,n);return o*o*(3-2*o)}function expEaseOut(e,t,n){const o=linstep(e,t,n);return 1===o?1:1-Math.pow(2,-10*o)}function interpolate(e,t,n=1e3,o=expEaseOut){let i,a,r=gUniforms.get(e).value;Array.isArray(r)&&(r=[...r]);const l=s=>{if(void 0===i&&(i=s,a=i+n),s<a){let n=mix(r,t,o(i,a,s));gUniforms.get(e).value=n,requestAnimationFrame(l)}else gUniforms.get(e).value=t,createUniformGui();onUniformUpdate()};requestAnimationFrame(l)}init(),timeElem.addEventListener("focusout",(()=>{0!=timeElem.innerText.length&&"."!=timeElem.innerText||(timeElem.innerText="0.00"),onUniformUpdate()})),timeElem.onkeypress=e=>{let t=String.fromCharCode(e.keyCode);window.getSelection().getRangeAt(0).startOffset;const n=timeElem.innerText.search(/\./);(!/[0-9]|\./.test(t)||"."==t&&n>=0)&&e.preventDefault()},timeElem.oninput=()=>{onUniformUpdate()},window.addEventListener("keydown",(e=>{"Backquote"!=e.code||e.ctrlKey?"Backquote"==e.code&&e.ctrlKey?("none"==commandElem.style.display?(commandElem.style.display="",commandElem.focus()):(commandElem.style.display="none",commandElem.value=""),e.preventDefault()):"Digit1"==e.code&&e.ctrlKey?("none"==gui.domElement.style.display?gui.show():gui.hide(),e.preventDefault()):"Enter"==e.code&&e.ctrlKey?(compilePromise=compile(),e.preventDefault()):"KeyF"==e.code&&e.altKey?(document.fullscreenElement?document.exitFullscreen():document.documentElement.requestFullscreen(),e.preventDefault()):"ArrowUp"==e.code&&e.altKey?animateController.setValue(!configGui.animate):"ArrowDown"==e.code&&e.altKey&&(timeElem.innerText="0.000",onUniformUpdate()):("none"==codeElem.style.display?(codeElem.style.display="flex",updateCodeEditorType()):codeElem.style.display="none",e.preventDefault())})),commandElem.addEventListener("keydown",(event=>{if("Enter"==event.code){let execStr=commandElem.value,guiVar=[...commandElem.value.matchAll(assignmentRegex)];if(1==guiVar.length&&gUniforms.has(guiVar[0][1])){const e=execStr.substr(guiVar[0][0].length);execStr=`interpolate('${guiVar[0][1]}', ${e});`,console.info(execStr)}try{let result=eval(execStr);SnackBar({status:"success",message:result})}catch(e){return void SnackBar({status:"error",message:e})}commandElem.style.display="none",commandElem.value=""}})),canvas.ondragover=e=>{e.preventDefault()},canvas.ondrop=e=>{if(e.preventDefault(),e.dataTransfer.items)for(var t=0;t<e.dataTransfer.items.length;t++)if("file"==e.dataTransfer.items[t].kind){var n=e.dataTransfer.items[t].getAsFile();createImageBitmap(n).then((e=>{}))}};</script></html>