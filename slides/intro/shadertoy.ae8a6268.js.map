{"mappings":"AAAAA,eAAeC,OAAO,iBAAkB,cAAcC,kBAC1CC,gCACV,MAAO,CAAC,M,CAETC,cACCC,O,CAEDC,2BACCC,KAAKC,KAAKD,KAAKE,I,CAEhBC,oBACCH,KAAKI,QAAU,GAAKJ,KAAKI,SAAW,oL,CAErCH,KAAMI,EAAKC,GACV,IAAKD,IAAQA,EAAIE,WAAW,QAC3B,MAAM,IAAIC,MAAM,sBAAsBH,oCACvCI,QAAQC,IAAI,0BAA2BL,GACvCL,KAAKW,OAAS,+dA4BdX,KAAKY,WAAWP,EAAKC,EAAS,GAAGO,MAAKC,GAAOA,EAAIC,SAAQF,MAAKG,IACzDA,IACHhB,KAAKW,OAASK,EAAKC,QAAO,iBAAmB,2BAClCZ,u0BAkBH,IACPa,OAAMC,GAAKV,QAAQW,MAAM,8BAA+BD,I,CAE5DP,WAAYP,EAAKC,EAASe,GACzB,MAAMC,GAAWhB,GAAW,IAAIgB,SAAW,CAC1C,uCACA,2BACA,6CAED,OAAOC,MAAMD,EAAQD,GAAKhB,EAAKC,GAASO,MAAKC,IAC5C,IAAKA,EAAIU,GACR,MAAM,IAAIhB,MAAM,GAAGM,EAAIW,UAAUX,EAAIY,cACtC,OAAOZ,CAAG,IACRI,OAAME,IACR,GAAIC,IAAMC,EAAQK,OAAS,EAC1B,MAAMP,EACP,OAAOpB,KAAKY,WAAWP,EAAKC,EAASe,EAAI,EAAE,G,GAG3C,CAACO,QAAS","sources":["slides/intro/x-frame-bypass.js"],"sourcesContent":["customElements.define('x-frame-bypass', class extends HTMLIFrameElement {\n\tstatic get observedAttributes() {\n\t\treturn ['src']\n\t}\n\tconstructor () {\n\t\tsuper()\n\t}\n\tattributeChangedCallback () {\n\t\tthis.load(this.src)\n\t}\n\tconnectedCallback () {\n\t\tthis.sandbox = '' + this.sandbox || 'allow-forms allow-modals allow-pointer-lock allow-popups allow-popups-to-escape-sandbox allow-presentation allow-same-origin allow-scripts allow-top-navigation-by-user-activation' // all except allow-top-navigation\n\t}\n\tload (url, options) {\n\t\tif (!url || !url.startsWith('http'))\n\t\t\tthrow new Error(`X-Frame-Bypass src ${url} does not start with http(s)://`)\n\t\tconsole.log('X-Frame-Bypass loading:', url)\n\t\tthis.srcdoc = `<html>\n<head>\n\t<style>\n\t.loader {\n\t\tposition: absolute;\n\t\ttop: calc(50% - 25px);\n\t\tleft: calc(50% - 25px);\n\t\twidth: 50px;\n\t\theight: 50px;\n\t\tbackground-color: #333;\n\t\tborder-radius: 50%;  \n\t\tanimation: loader 1s infinite ease-in-out;\n\t}\n\t@keyframes loader {\n\t\t0% {\n\t\ttransform: scale(0);\n\t\t}\n\t\t100% {\n\t\ttransform: scale(1);\n\t\topacity: 0;\n\t\t}\n\t}\n\t</style>\n</head>\n<body>\n\t<div class=\"loader\"></div>\n</body>\n</html>`\n\t\tthis.fetchProxy(url, options, 0).then(res => res.text()).then(data => {\n\t\t\tif (data)\n\t\t\t\tthis.srcdoc = data.replace(/<head([^>]*)>/i, `<head$1>\n\t<base href=\"${url}\">\n\t<script>\n\t// X-Frame-Bypass navigation event handlers\n\tdocument.addEventListener('click', e => {\n\t\tif (frameElement && document.activeElement && document.activeElement.href) {\n\t\t\te.preventDefault()\n\t\t\tframeElement.load(document.activeElement.href)\n\t\t}\n\t})\n\tdocument.addEventListener('submit', e => {\n\t\tif (frameElement && document.activeElement && document.activeElement.form && document.activeElement.form.action) {\n\t\t\te.preventDefault()\n\t\t\tif (document.activeElement.form.method === 'post')\n\t\t\t\tframeElement.load(document.activeElement.form.action, {method: 'post', body: new FormData(document.activeElement.form)})\n\t\t\telse\n\t\t\t\tframeElement.load(document.activeElement.form.action + '?' + new URLSearchParams(new FormData(document.activeElement.form)))\n\t\t}\n\t})\n\t</script>`)\n\t\t}).catch(e => console.error('Cannot load X-Frame-Bypass:', e))\n\t}\n\tfetchProxy (url, options, i) {\n\t\tconst proxies = (options || {}).proxies || [\n\t\t\t'https://cors-anywhere.herokuapp.com/',\n\t\t\t'https://yacdn.org/proxy/',\n\t\t\t'https://api.codetabs.com/v1/proxy/?quest='\n\t\t]\n\t\treturn fetch(proxies[i] + url, options).then(res => {\n\t\t\tif (!res.ok)\n\t\t\t\tthrow new Error(`${res.status} ${res.statusText}`);\n\t\t\treturn res\n\t\t}).catch(error => {\n\t\t\tif (i === proxies.length - 1)\n\t\t\t\tthrow error\n\t\t\treturn this.fetchProxy(url, options, i + 1)\n\t\t})\n\t}\n}, {extends: 'iframe'})"],"names":["customElements","define","HTMLIFrameElement","observedAttributes","constructor","super","attributeChangedCallback","this","load","src","connectedCallback","sandbox","url","options","startsWith","Error","console","log","srcdoc","fetchProxy","then","res","text","data","replace","catch","e","error","i","proxies","fetch","ok","status","statusText","length","extends"],"version":3,"file":"shadertoy.ae8a6268.js.map"}